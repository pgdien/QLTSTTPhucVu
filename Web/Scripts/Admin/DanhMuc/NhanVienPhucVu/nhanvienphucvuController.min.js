admin.controller("nhanvienphucvuController",["$scope","$http",function(n,t){function f(){u()}function u(){t.get(i).then(function(t){t.status==200&&(n.nhanvienPhucVus=t.data)})}var i,r;n.nhanvienPhucVus=[];n.nhanvienPhucVu={};n.selectedNhanVienPhucVus=[];i="/API/DM_NhanVienPhucVuAPI";n.modifyNhanVienPhucVu=!1;n.deleteNhanVienPhucVu=!1;n.titlePopupModifyNhanVienPhucVu="Thêm nhân viên phục vụ";n.popupModifyNhanVienPhucVu={width:"auto",height:"auto",contentTemplate:"templateModifyNhanVienPhucVu",showTitle:!0,resizeEnabled:!0,bindingOptions:{title:"titlePopupModifyNhanVienPhucVu",visible:"modifyNhanVienPhucVu"}};n.popupDeleteNhanVienPhucVu={width:"auto",height:"auto",contentTemplate:"templateDeleteNhanVienPhucVu",showTitle:!1,bindingOptions:{visible:"deleteNhanVienPhucVu"}};n.controlNhanVienPhucVu={ten:{showClearButton:!0,valueChangeEvent:"keyup",bindingOptions:{value:"nhanvienPhucVu.ten"}},tenHoaDon:{showClearButton:!0,valueChangeEvent:"keyup",bindingOptions:{value:"nhanvienPhucVu.tenHoaDon"}},sdt:{showClearButton:!0,valueChangeEvent:"keyup",bindingOptions:{value:"nhanvienPhucVu.sdt"}},diachi:{showClearButton:!0,valueChangeEvent:"keyup",bindingOptions:{value:"nhanvienPhucVu.diachi"}},ngayVaoLam:{type:"date",displayFormat:"dd/MM/yyyy",bindingOptions:{value:"nhanvienPhucVu.ngayVaoLam"}}};n.gridNhanVienPhucVus={bindingOptions:{dataSource:"nhanvienPhucVus"},allowColumnResizing:!0,columnAutoWidth:!0,columnChooser:{emptyPanelText:"Kéo và thả cột muốn ẩn vào đây",enabled:!0,mode:"select",title:"Lựa chọn cột"},columnFixing:{enabled:!0,texts:{fix:"Cố định cột",leftPosition:"Bên trái",rightPosition:"Bên phải",unfix:"Hủy cố định"}},columns:[{alignment:"left",allowEditing:!1,caption:"ID",dataField:"id",fixed:!0,fixedPosition:"left",width:90,visible:!1},{alignment:"left",caption:"Tên nhân viên",dataField:"ten",dataType:"string"},{alignment:"left",caption:"Tên trên HĐ",dataField:"tenHoaDon",dataType:"string"},{alignment:"left",caption:"SĐT",dataField:"sdt",dataType:"string"},{alignment:"left",caption:"Địa chỉ",dataField:"diachi",dataType:"string"},{alignment:"left",caption:"Ngày vào làm",dataField:"ngayVaoLam",dataType:"date",format:"dd/MM/yyyy",customizeText:function(n){return n.valueText}},{alignment:"right",caption:"Giá DV(vnđ/phút)",dataField:"dongia",format:{type:"fixedPoint",precision:0}},],editing:{mode:"cell",allowAdding:!1,allowDeleting:!1,allowUpdating:!1,texts:{addRow:"Thêm",cancelAllChanges:"Không thay đổi",cancelRowChanges:"Hủy",confirmDeleteMessage:"Bạn có chắc chắn muốn xóa?",deleteRow:"Xóa",editRow:"Sửa",saveAllChanges:"Lưu thay đổi",saveRowChanges:"Lưu",undeleteRow:"Không xóa",validationCancelChanges:"Hủy thay đổi"}},"export":{allowExportSelectedData:!0,enabled:!0,excelFilterEnabled:!0,excelWrapTextEnabled:!0,fileName:"Danh sách Nhân viên phục vụ",texts:{exportAll:"Xuất toàn bộ Dữ liệu",exportSelectedRows:"Xuất dữ liệu đang chọn",exportTo:"Trích xuất"}},filterRow:{applyFilterText:"Áp dụng bộ lọc",betweenEndText:"Kết thúc",betweenStartText:"Bắt đầu",resetOperationText:"Thiết lập lại",showAllText:"(Tất cả)",visible:!0},grouping:{contextMenuEnabled:!0,expandMode:"rowClick",texts:{groupByThisColumn:"Nhóm theo Cột này",groupContinuedMessage:"Tiếp tục từ trang trước",groupContinuesMessage:"Tiếp tục trên các trang tiếp theo",ungroup:"Bỏ nhóm",ungroupAll:"Bỏ tất cả nhóm"}},groupPanel:{emptyPanelText:"Kéo một cột vào đây để nhóm theo cột đó",visible:!1},headerFilter:{texts:{cancel:"Hủy",emptyValue:"(Trống)",ok:"Đồng ý"},visible:!0},hoverStateEnabled:!0,loadPanel:{enabled:!0,text:"Đang tải ..."},noDataText:"Không có dữ liệu",pager:{infoText:"Trang {0} của {1}",showInfo:!0,showNavigationButtons:!0,showPageSizeSelector:!0,visible:!0},paging:{enabled:!0,pageIndex:0,pageSize:50},remoteOperations:{grouping:!1,summary:!1},rowAlternationEnabled:!1,scrolling:{preloadEnabled:!0},searchPanel:{placeholder:"Tìm kiếm ..."},selection:{mode:"multiple",showCheckBoxesMode:"onClick"},showBorders:!0,showRowLines:!0,sorting:{ascendingText:"Sắp xếp Tăng dần",clearText:"Xóa Sắp xếp",descendingText:"Sắp xếp Giảm dần"},summary:{texts:{count:"{0}",sum:"{0}"},groupItems:[{column:"id",summaryType:"count"}],totalItems:[{column:"id",summaryType:"count"}]},wordWrapEnabled:!1,onToolbarPreparing:function(t){var i=t.component;t.toolbarOptions.items.unshift({location:"after",widget:"dxButton",options:{hint:"Thêm",icon:"add",type:"success",onClick:function(){n.AddNhanVienPhucVu()}}},{location:"after",widget:"dxButton",options:{hint:"Sửa",icon:"edit",type:"default",onClick:function(){n.EditNhanVienPhucVu()}}},{location:"after",widget:"dxButton",options:{hint:"Xóa",icon:"trash",type:"danger",onClick:function(){n.DeleteNhanVienPhucVu()}}},{location:"after",widget:"dxButton",options:{hint:"Load lại Dữ liệu",icon:"refresh",onClick:function(){u()}}})},onRowClick:function(t){var i=t.component;i.clickCount=i.clickCount?i.clickCount+1:1;i.clickCount==1?(i.lastClickTime=new Date,setTimeout(function(){i.lastClickTime=0;i.clickCount=0},350)):i.clickCount==2&&(new Date-i.lastClickTime<300&&(n.nhanvienPhucVu=angular.copy(t.data),n.EditNhanVienPhucVu()),i.clickCount=0,i.lastClickTime=0)},onSelectionChanged:function(t){n.selectedNhanVienPhucVus=angular.copy(t.selectedRowsData)}};r=[{value:"add",text:" Thêm",icon:"fa fa-plus"},{value:"edit",text:" Sửa",icon:"fa fa-pencil"},{value:"delete",text:" Xóa",icon:"fa fa-times"}];n.contextMenuNhanVienPhucVu={dataSource:r,width:100,target:"#nhanvienPhucVu",itemTemplate:function(n){var t=$("<div><\/div>");return n.icon&&t.append('<span class="'+n.icon+'"><span>'),t.append(n.text),t},onItemClick:function(t){if(!t.itemData.items)switch(t.itemData.value){case"add":n.AddNhanVienPhucVu();break;case"edit":n.EditNhanVienPhucVu();break;case"delete":n.DeleteNhanVienPhucVu()}}};f();n.AddNhanVienPhucVu=function(){n.nhanvienPhucVu={};n.titlePopupModifyNhanVienPhucVu="Thêm nhân viên phục vụ";n.modifyNhanVienPhucVu=!0};n.EditNhanVienPhucVu=function(){n.selectedNhanVienPhucVus.length==0?toastr.error("Chọn 1 dòng để sửa"):(n.nhanvienPhucVu=angular.copy(n.selectedNhanVienPhucVus[0]),n.titlePopupModifyNhanVienPhucVu="Sửa nhân viên phục vụ",n.modifyNhanVienPhucVu=!0)};n.SaveNhanVienPhucVu=function(){angular.isDefined(n.nhanvienPhucVu.id)?t.put(i+"/"+n.nhanvienPhucVu.id,n.nhanvienPhucVu).then(function(t){t.status==204?angular.forEach(n.nhanvienPhucVus,function(t,i){t.id==n.nhanvienPhucVu.id&&(n.nhanvienPhucVus[i]=angular.copy(n.nhanvienPhucVu),toastr.success("Thành công","Sửa"),n.modifyNhanVienPhucVu=!1)}):toastr.error("Thất bại","Sửa")}):t.post(i,n.nhanvienPhucVu).then(function(t){t.status==201?(n.nhanvienPhucVus.push(t.data),toastr.success("Thành công","Thêm"),n.modifyNhanVienPhucVu=!1):toastr.error("Thất bại","Thêm")})};n.CancelSaveNhanVienPhucVu=function(){n.modifyNhanVienPhucVu=!1};n.DeleteNhanVienPhucVu=function(){n.selectedNhanVienPhucVus.length==0?toastr.error("Chọn dòng để xóa"):n.deleteNhanVienPhucVu=!0};n.ConfirmDeleteNhanVienPhucVu=function(){angular.forEach(n.selectedNhanVienPhucVus,function(r){t.delete(i+"/"+r.id).then(function(t){t.status==200?angular.forEach(n.nhanvienPhucVus,function(t,i){r.id===t.id&&n.nhanvienPhucVus.splice(i,1)}):toastr.error("Thất bại","Xóa")})});toastr.success("Thành công","Xóa");n.deleteNhanVienPhucVu=!1};n.CancelDeleteNhanVienPhucVu=function(){n.deleteNhanVienPhucVu=!1}}]);