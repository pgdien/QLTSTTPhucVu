admin.controller("banController",["$scope","$http",function(n,t){function o(){f();r()}function f(){t.get(u).then(function(t){t.status==200&&(n.khuvucs=t.data)})}function r(){n.khuvuc.id==null?t.get(i).then(function(t){t.status==200&&(n.bans=t.data)}):t.get(i+"?att=idKhuVuc&&value="+n.khuvuc.id).then(function(t){t.status==200&&(n.bans=t.data)})}var u,i,e;n.khuvucs=[];n.khuvuc={};n.bans=[];n.ban={};u="/API/DM_KhuVucAPI/";i="/API/DM_BanAPI";n.modifyKhuVuc=!1;n.deleteKhuVuc=!1;n.titlePopupModifyKhuVuc="Thêm khu vực";n.popupModifyKhuVuc={width:"auto",height:"auto",contentTemplate:"templateModifyKhuVuc",showTitle:!0,resizeEnabled:!0,bindingOptions:{title:"titlePopupModifyKhuVuc",visible:"modifyKhuVuc"}};n.popupDeleteKhuVuc={width:"auto",height:"auto",contentTemplate:"templateDeleteKhuVuc",showTitle:!1,bindingOptions:{visible:"deleteKhuVuc"}};n.modifyBan=!1;n.deleteBan=!1;n.titlePopupModifyBan="Thêm bàn";n.popupModifyBan={width:"auto",height:"auto",contentTemplate:"templateModifyBan",showTitle:!0,resizeEnabled:!0,bindingOptions:{title:"titlePopupModifyBan",visible:"modifyBan"}};n.popupDeleteBan={width:"auto",height:"auto",contentTemplate:"templateDeleteBan",showTitle:!1,bindingOptions:{visible:"deleteBan"}};n.controlKhuVuc={ten:{showClearButton:!0,valueChangeEvent:"keyup",bindingOptions:{value:"khuvuc.ten"}}};n.controlBan={ten:{showClearButton:!0,valueChangeEvent:"keyup",bindingOptions:{value:"ban.ten"}},khuvuc:{displayExpr:"ten",valueExpr:"id",searchEnabled:!0,noDataText:"Không có dữ liệu",placeholder:"Chọn ...",bindingOptions:{items:"khuvucs",value:"ban.idKhuVuc"}},addKhuVuc:{icon:"plus",onClick:function(){n.modifyKhuVuc=!0}}};n.listKhuVucs={bindingOptions:{dataSource:"khuvucs"},height:"100%",onItemClick:function(t){n.khuvuc=angular.copy(t.itemData);r()},onItemContextMenu:function(t){n.khuvuc=angular.copy(t.itemData)}};n.tileViewBans={width:800,height:500,baseItemHeight:117,baseItemWidth:120,itemMargin:10,direction:"vertical",bindingOptions:{items:"bans"},onItemContextMenu:function(t){n.ban=angular.copy(t.itemData)}};e=[{value:"add",text:" Thêm",icon:"fa fa-plus"},{value:"edit",text:" Sửa",icon:"fa fa-pencil"},{value:"delete",text:" Xóa",icon:"fa fa-times"}];n.contextMenuKhuVuc={dataSource:e,width:100,target:"#khuvuc",itemTemplate:function(n){var t=$("<div><\/div>");return n.icon&&t.append('<span class="'+n.icon+'"><span>'),t.append(n.text),t},onItemClick:function(t){if(!t.itemData.items)switch(t.itemData.value){case"add":n.AddKhuVuc();break;case"edit":n.EditKhuVuc();break;case"delete":n.DeleteKhuVuc()}}};n.contextMenuBan={dataSource:e,width:100,target:"#ban",itemTemplate:function(n){var t=$("<div><\/div>");return n.icon&&t.append('<span class="'+n.icon+'"><span>'),t.append(n.text),t},onItemClick:function(t){if(!t.itemData.items)switch(t.itemData.value){case"add":n.AddBan();break;case"edit":n.EditBan();break;case"delete":n.DeleteBan()}}};o();n.AddKhuVuc=function(){n.khuvuc={};n.titlePopupModifyKhuVuc="Thêm khu vực";n.modifyKhuVuc=!0};n.EditKhuVuc=function(){n.titlePopupModifyKhuVuc="Sửa khu vực";n.modifyKhuVuc=!0};n.SaveKhuVuc=function(){angular.isDefined(n.khuvuc.id)?t.put(u+n.khuvuc.id,n.khuvuc).then(function(t){t.status==204?(f(),toastr.success("Thành công","Sửa"),n.modifyKhuVuc=!1):toastr.error("Thất bại","Sửa")}):t.post(u,n.khuvuc).then(function(t){t.status==201?(f(),toastr.success("Thành công","Thêm"),n.modifyKhuVuc=!1):toastr.error("Thất bại","Thêm")})};n.CancelSaveKhuVuc=function(){n.modifyKhuVuc=!1};n.DeleteKhuVuc=function(){n.deleteKhuVuc=!0};n.ConfirmDeleteKhuVuc=function(){t.delete(u+n.khuvuc.id).then(function(t){t.status==200?(f(),toastr.success("Thành công","Xóa"),n.deleteKhuVuc=!1):toastr.error("Thất bại","Xóa")})};n.CancelDeleteKhuVuc=function(){n.deleteKhuVuc=!1};n.GetAllBan=function(){n.khuvuc={};r()};n.AddBan=function(){n.ban=n.khuvuc.id==null?{}:{idKhuVuc:n.khuvuc.id};n.titlePopupModifyBan="Thêm bàn";n.modifyBan=!0};n.EditBan=function(){n.titlePopupModifyBan="Sửa bàn";n.modifyBan=!0};n.SaveBan=function(){angular.isDefined(n.ban.id)?t.put(i+"/"+n.ban.id,n.ban).then(function(t){t.status==204?(r(),toastr.success("Thành công","Sửa"),n.modifyBan=!1):toastr.error("Thất bại","Sửa")}):t.post(i,n.ban).then(function(t){t.status==201?(r(),toastr.success("Thành công","Thêm"),n.modifyBan=!1):toastr.error("Thất bại","Thêm")})};n.CancelSaveBan=function(){n.modifyBan=!1};n.DeleteBan=function(){n.deleteBan=!0};n.ConfirmDeleteBan=function(){t.delete(i+"/"+n.ban.id).then(function(t){t.status==200?(r(),toastr.success("Thành công","Xóa"),n.deleteBan=!1):toastr.error("Thất bại","Xóa")})};n.CancelDeleteBan=function(){n.deleteBan=!1}}]);